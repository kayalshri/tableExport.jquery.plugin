!function(a){a.fn.extend({tableExport:function(b){function s(a){return"true"==c.htmlContent?content_data=a.html().trim():content_data=a.text().trim(),"true"==c.escape&&(content_data=escape(content_data)),content_data}var c={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},b=a.extend(c,b),d=this;if("csv"==c.type||"txt"==c.type){var e="";a(d).find("thead").find("tr").each(function(){e+="\n",a(this).filter(":visible").find("th").each(function(b,d){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&(e+='"'+s(a(this))+'"'+c.separator)}),e=a.trim(e),e=a.trim(e).substring(0,e.length-1)}),a(d).find("tbody").find("tr").each(function(){e+="\n",a(this).filter(":visible").find("td").each(function(b,d){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&(e+='"'+s(a(this))+'"'+c.separator)}),e=a.trim(e).substring(0,e.length-1)}),"true"==c.consoleLog&&console.log(e);var f="base64,"+a.base64.encode(e);window.open("data:application/"+c.type+";filename=exportData;"+f)}else if("sql"==c.type){var e="INSERT INTO `"+c.tableName+"` (";a(d).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,d){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&(e+="`"+s(a(this))+"`,")}),e=a.trim(e),e=a.trim(e).substring(0,e.length-1)}),e+=") VALUES ",a(d).find("tbody").find("tr").each(function(){e+="(",a(this).filter(":visible").find("td").each(function(b,d){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&(e+='"'+s(a(this))+'",')}),e=a.trim(e).substring(0,e.length-1),e+="),"}),e=a.trim(e).substring(0,e.length-1),e+=";","true"==c.consoleLog&&console.log(e);var f="base64,"+a.base64.encode(e);window.open("data:application/sql;filename=exportData;"+f)}else if("json"==c.type){var g=[];a(d).find("thead").find("tr").each(function(){var d=[];a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&d.push(s(a(this)))}),g.push(d)});var h=[];a(d).find("tbody").find("tr").each(function(){var d=[];a(this).filter(":visible").find("td").each(function(b,e){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&d.push(s(a(this)))}),h.push(d)});var i=[];i.push({header:g,data:h}),"true"==c.consoleLog&&console.log(JSON.stringify(i));var f="base64,"+a.base64.encode(JSON.stringify(i));window.open("data:application/json;filename=exportData;"+f)}else if("xml"==c.type){var j='<?xml version="1.0" encoding="utf-8"?>';j+="<tabledata><fields>",a(d).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,d){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&(j+="<field>"+s(a(this))+"</field>")})}),j+="</fields><data>";var k=1;a(d).find("tbody").find("tr").each(function(){j+='<row id="'+k+'">';var b=0;a(this).filter(":visible").find("td").each(function(d,e){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(d)==-1&&(j+="<column-"+b+">"+s(a(this))+"</column-"+b+">"),b++}),k++,j+="</row>"}),j+="</data></tabledata>","true"==c.consoleLog&&console.log(j);var f="base64,"+a.base64.encode(j);window.open("data:application/xml;filename=exportData;"+f)}else if("excel"==c.type||"doc"==c.type||"powerpoint"==c.type){var l="<table>";a(d).find("thead").find("tr").each(function(){l+="<tr>",a(this).filter(":visible").find("th").each(function(b,d){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1&&(l+="<td>"+s(a(this))+"</td>")}),l+="</tr>"});var k=1;a(d).find("tbody").find("tr").each(function(){l+="<tr>";var b=0;a(this).filter(":visible").find("td").each(function(d,e){"none"!=a(this).css("display")&&c.ignoreColumn.indexOf(d)==-1&&(l+="<td>"+s(a(this))+"</td>"),b++}),k++,l+="</tr>"}),l+="</table>","true"==c.consoleLog&&console.log(l);var m="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+c.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";m+="<head>",m+="<!--[if gte mso 9]>",m+="<xml>",m+="<x:ExcelWorkbook>",m+="<x:ExcelWorksheets>",m+="<x:ExcelWorksheet>",m+="<x:Name>",m+="{worksheet}",m+="</x:Name>",m+="<x:WorksheetOptions>",m+="<x:DisplayGridlines/>",m+="</x:WorksheetOptions>",m+="</x:ExcelWorksheet>",m+="</x:ExcelWorksheets>",m+="</x:ExcelWorkbook>",m+="</xml>",m+="<![endif]-->",m+="</head>",m+="<body>",m+=l,m+="</body>",m+="</html>";var f="base64,"+a.base64.encode(m);window.open("data:application/vnd.ms-"+c.type+";filename=exportData.doc;"+f)}else if("png"==c.type)html2canvas(a(d),{onrendered:function(a){var b=a.toDataURL("image/png");window.open(b)}});else if("pdf"==c.type){var n=new jsPDF("p","pt","a4",!0);n.setFontSize(c.pdfFontSize);var o=c.pdfLeftMargin;a(d).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,d){if("none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1){var e=o+50*b;n.text(e,20,s(a(this)))}})});var p=20,q=1,r=0;a(d).find("tbody").find("tr").each(function(b,d){rowCalc=b+1,rowCalc%26==0&&(n.addPage(),q++,p+=10),r=p+10*rowCalc-280*(q-1),a(this).filter(":visible").find("td").each(function(b,d){if("none"!=a(this).css("display")&&c.ignoreColumn.indexOf(b)==-1){var e=o+50*b;n.text(e,r,s(a(this)))}})}),n.output("datauri")}}})}(jQuery);
